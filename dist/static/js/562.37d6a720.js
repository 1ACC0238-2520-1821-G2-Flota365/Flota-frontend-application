"use strict";(self["webpackChunkflota365_vue"]=self["webpackChunkflota365_vue"]||[]).push([[562],{113:(e,t,i)=>{var r=i(6518),s=i(9213).find,a=i(6469),n="find",o=!0;n in[]&&Array(1)[n]((function(){o=!1})),r({target:"Array",proto:!0,forced:o},{find:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),a(n)},116:(e,t,i)=>{var r=i(6518),s=i(9565),a=i(2652),n=i(9306),o=i(8551),c=i(1767),l=i(9539),d=i(4549),u=d("find",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{find:function(e){o(this);try{n(e)}catch(r){l(this,"throw",r)}if(u)return s(u,this,e);var t=c(this),i=0;return a(t,(function(t,r){if(e(t,i++))return r(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},380:(e,t,i)=>{var r=i(9504),s=i(9039),a=i(533).start,n=RangeError,o=isFinite,c=Math.abs,l=Date.prototype,d=l.toISOString,u=r(l.getTime),v=r(l.getUTCDate),g=r(l.getUTCFullYear),m=r(l.getUTCHours),h=r(l.getUTCMilliseconds),f=r(l.getUTCMinutes),p=r(l.getUTCMonth),S=r(l.getUTCSeconds);e.exports=s((function(){return"0385-07-25T07:06:39.999Z"!==d.call(new Date(-50000000000001))}))||!s((function(){d.call(new Date(NaN))}))?function(){if(!o(u(this)))throw new n("Invalid time value");var e=this,t=g(e),i=h(e),r=t<0?"-":t>9999?"+":"";return r+a(c(t),r?6:4,0)+"-"+a(p(e)+1,2,0)+"-"+a(v(e),2,0)+"T"+a(m(e),2,0)+":"+a(f(e),2,0)+":"+a(S(e),2,0)+"."+a(i,3,0)+"Z"}:d},533:(e,t,i)=>{var r=i(9504),s=i(8014),a=i(655),n=i(2333),o=i(7750),c=r(n),l=r("".slice),d=Math.ceil,u=function(e){return function(t,i,r){var n,u,v=a(o(t)),g=s(i),m=v.length,h=void 0===r?" ":a(r);return g<=m||""===h?v:(n=g-m,u=c(h,d(n/h.length)),u.length>n&&(u=l(u,0,n)),e?v+u:u+v)}};e.exports={start:u(!1),end:u(!0)}},788:(e,t,i)=>{var r=i(34),s=i(4576),a=i(8227),n=a("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[n])?!!t:"RegExp"===s(e))}},1148:(e,t,i)=>{var r=i(6518),s=i(9565),a=i(2652),n=i(9306),o=i(8551),c=i(1767),l=i(9539),d=i(4549),u=d("every",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(e){o(this);try{n(e)}catch(r){l(this,"throw",r)}if(u)return s(u,this,e);var t=c(this),i=0;return!a(t,(function(t,r){if(!e(t,i++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1436:(e,t,i)=>{var r=i(8227),s=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[s]=!1,"/./"[e](t)}catch(r){}}return!1}},1688:(e,t,i)=>{var r=i(6518),s=i(380);r({target:"Date",proto:!0,forced:Date.prototype.toISOString!==s},{toISOString:s})},1699:(e,t,i)=>{var r=i(6518),s=i(9504),a=i(5749),n=i(7750),o=i(655),c=i(1436),l=s("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~l(o(n(this)),o(a(e)),arguments.length>1?arguments[1]:void 0)}})},2333:(e,t,i)=>{var r=i(1291),s=i(655),a=i(7750),n=RangeError;e.exports=function(e){var t=s(a(this)),i="",o=r(e);if(o<0||o===1/0)throw new n("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(i+=t);return i}},4423:(e,t,i)=>{var r=i(6518),s=i(9617).includes,a=i(9039),n=i(6469),o=a((function(){return!Array(1).includes()}));r({target:"Array",proto:!0,forced:o},{includes:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),n("includes")},5749:(e,t,i)=>{var r=i(788),s=TypeError;e.exports=function(e){if(r(e))throw new s("The method doesn't accept regular expressions");return e}},7562:(e,t,i)=>{i.r(t),i.d(t,{default:()=>m});var r=function(){var e=this,t=e._self._c;return t("div",[t("Header",{attrs:{title:e.isEditing?"Editar Servicio":"Nuevo Servicio"}}),t("div",{staticStyle:{"margin-bottom":"1.5rem"}},[t("nav",{staticStyle:{display:"flex","align-items":"center",gap:"0.5rem",color:"#666","font-size":"0.9rem"}},[t("router-link",{staticStyle:{color:"var(--color-turquoise)","text-decoration":"none"},attrs:{to:"/fleet-management"}},[t("i",{staticClass:"fas fa-arrow-left",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Gestión de Flota ")]),t("span",[e._v("/")]),t("span",[e._v(e._s(e.isEditing?"Editar Servicio":"Nuevo Servicio"))])],1)]),t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("h2",{staticClass:"card-title"},[t("i",{staticClass:"fas fa-clipboard-list",staticStyle:{"margin-right":"0.5rem",color:"var(--color-turquoise)"}}),e._v(" "+e._s(e.isEditing?"Editar Servicio":"Crear Nuevo Servicio")+" ")]),t("div",{staticStyle:{display:"flex",gap:"0.75rem"}},[t("button",{staticClass:"btn btn-secondary",on:{click:e.cancelForm}},[t("i",{staticClass:"fas fa-times",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Cancelar ")]),t("button",{staticClass:"btn btn-primary",attrs:{disabled:!e.isFormValid},on:{click:e.saveService}},[t("i",{staticClass:"fas fa-save",staticStyle:{"margin-right":"0.5rem"}}),e._v(" "+e._s(e.isEditing?"Actualizar":"Crear")+" Servicio ")])])]),e.loading?t("div",{staticStyle:{"text-align":"center",padding:"3rem"}},[t("i",{staticClass:"fas fa-spinner fa-spin",staticStyle:{"font-size":"2rem",color:"var(--color-turquoise)"}}),t("p",[e._v("Cargando información...")])]):e.error?t("div",{staticStyle:{"background-color":"#fee",border:"1px solid #fcc",padding:"1rem","border-radius":"4px",margin:"1.5rem"}},[t("p",{staticStyle:{color:"#c00",margin:"0"}},[t("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" "+e._s(e.error)+" ")])]):t("form",{staticStyle:{padding:"2rem"},on:{submit:function(t){return t.preventDefault(),e.saveService.apply(null,arguments)}}},[t("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr",gap:"3rem"}},[t("div",[t("div",{staticClass:"form-section"},[e._m(0),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Código del Servicio")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.service.code,expression:"service.code"}],staticClass:"form-control",staticStyle:{"background-color":"#f8f9fa","font-weight":"bold","font-size":"1.1rem"},attrs:{type:"text",readonly:""},domProps:{value:e.service.code},on:{input:function(t){t.target.composing||e.$set(e.service,"code",t.target.value)}}})]),t("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Fecha del Servicio *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.service.serviceDate,expression:"service.serviceDate"}],staticClass:"form-control",attrs:{type:"date",required:""},domProps:{value:e.service.serviceDate},on:{input:function(t){t.target.composing||e.$set(e.service,"serviceDate",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Hora de Salida *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.service.departureTime,expression:"service.departureTime"}],staticClass:"form-control",attrs:{type:"time",required:""},domProps:{value:e.service.departureTime},on:{input:function(t){t.target.composing||e.$set(e.service,"departureTime",t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Vehículo *")]),t("div",{staticStyle:{position:"relative"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.vehicleSearchQuery,expression:"vehicleSearchQuery"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Buscar por placa o modelo...",required:"",autocomplete:"off"},domProps:{value:e.vehicleSearchQuery},on:{input:[function(t){t.target.composing||(e.vehicleSearchQuery=t.target.value)},e.searchVehicles],focus:function(t){e.showVehicleSuggestions=!0}}}),e.showVehicleSuggestions&&e.vehicleSuggestions.length>0?t("div",{staticClass:"autocomplete-dropdown"},e._l(e.vehicleSuggestions,(function(i){return t("div",{key:i.id,staticClass:"autocomplete-item",on:{click:function(t){return e.selectVehicle(i)}}},[t("div",{staticStyle:{"font-weight":"bold",color:"var(--color-turquoise)"}},[e._v(" "+e._s(i.licensePlate)+" ")]),t("div",{staticStyle:{"font-size":"0.85rem",color:"#666"}},[e._v(" "+e._s(i.brand)+" "+e._s(i.model)+" ("+e._s(i.year)+") ")])])})),0):e._e()])]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Conductor *")]),t("div",{staticStyle:{position:"relative"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.driverSearchQuery,expression:"driverSearchQuery"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Buscar por nombre o licencia...",required:"",autocomplete:"off"},domProps:{value:e.driverSearchQuery},on:{input:[function(t){t.target.composing||(e.driverSearchQuery=t.target.value)},e.searchDrivers],focus:function(t){e.showDriverSuggestions=!0}}}),e.showDriverSuggestions&&e.driverSuggestions.length>0?t("div",{staticClass:"autocomplete-dropdown"},e._l(e.driverSuggestions,(function(i){return t("div",{key:i.id,staticClass:"autocomplete-item",on:{click:function(t){return e.selectDriver(i)}}},[t("div",{staticStyle:{"font-weight":"bold",color:"var(--color-turquoise)"}},[e._v(" "+e._s(i.fullName)+" ")]),t("div",{staticStyle:{"font-size":"0.85rem",color:"#666"}},[e._v(" Licencia: "+e._s(i.licenseNumber)+" ")])])})),0):e._e()])]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Observaciones")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.service.observations,expression:"service.observations"}],staticClass:"form-control",attrs:{rows:"4",placeholder:"Observaciones adicionales del servicio..."},domProps:{value:e.service.observations},on:{input:function(t){t.target.composing||e.$set(e.service,"observations",t.target.value)}}})])])]),t("div",[t("div",{staticClass:"form-section"},[e._m(1),t("div",{staticClass:"form-group"},[e._m(2),t("div",{staticClass:"origin-container"},[t("div",{staticStyle:{"margin-bottom":"0.5rem"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.service.origin.address,expression:"service.origin.address"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Dirección completa (Ej: Av. Los Frutales 344, Urb. Los Jardines)",required:""},domProps:{value:e.service.origin.address},on:{input:function(t){t.target.composing||e.$set(e.service.origin,"address",t.target.value)}}})]),t("div",{staticStyle:{position:"relative"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.service.origin.district,expression:"service.origin.district"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Distrito de Lima...",required:"",autocomplete:"off"},domProps:{value:e.service.origin.district},on:{input:[function(t){t.target.composing||e.$set(e.service.origin,"district",t.target.value)},e.searchOriginDistricts],focus:function(t){e.showOriginSuggestions=!0}}}),e.showOriginSuggestions&&e.originSuggestions.length>0?t("div",{staticClass:"autocomplete-dropdown"},e._l(e.originSuggestions,(function(i){return t("div",{key:i,staticClass:"autocomplete-item",on:{click:function(t){return e.selectOriginDistrict(i)}}},[e._v(" "+e._s(i)+" ")])})),0):e._e()])])]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[t("i",{staticClass:"fas fa-flag-checkered",staticStyle:{color:"#dc3545","margin-right":"0.5rem"}}),e._v(" Puntos de Destino * ("+e._s(e.service.destinations.length)+") ")]),t("div",{staticClass:"destinations-container"},[e._l(e.service.destinations,(function(i,r){return t("div",{key:r,staticClass:"destination-card"},[t("div",{staticClass:"destination-header"},[t("span",{staticClass:"destination-number"},[t("i",{staticClass:"fas fa-map-pin"}),e._v(" Destino "+e._s(r+1)+" ")]),t("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:1===e.service.destinations.length},on:{click:function(t){return e.removeDestination(r)}}},[t("i",{staticClass:"fas fa-trash"})])]),t("div",{staticStyle:{"margin-top":"0.75rem"}},[t("div",{staticStyle:{"margin-bottom":"0.5rem"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.service.destinations[r].address,expression:"service.destinations[index].address"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Dirección completa del destino...",required:""},domProps:{value:e.service.destinations[r].address},on:{input:function(t){t.target.composing||e.$set(e.service.destinations[r],"address",t.target.value)}}})]),t("div",{staticStyle:{position:"relative"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.service.destinations[r].district,expression:"service.destinations[index].district"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Distrito de Lima...",required:"",autocomplete:"off"},domProps:{value:e.service.destinations[r].district},on:{input:[function(t){t.target.composing||e.$set(e.service.destinations[r],"district",t.target.value)},function(t){return e.searchDestinationDistricts(r)}],focus:function(t){e.activeDestinationIndex=r}}}),e.activeDestinationIndex===r&&e.destinationSuggestions.length>0?t("div",{staticClass:"autocomplete-dropdown"},e._l(e.destinationSuggestions,(function(i){return t("div",{key:i,staticClass:"autocomplete-item",on:{click:function(t){return e.selectDestinationDistrict(i,r)}}},[e._v(" "+e._s(i)+" ")])})),0):e._e()])])])})),t("button",{staticClass:"btn btn-secondary add-destination-btn",attrs:{type:"button"},on:{click:e.addDestination}},[t("i",{staticClass:"fas fa-plus",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Agregar Nuevo Destino ")])],2)])])])]),t("div",{staticClass:"service-summary"},[e._m(3),t("div",{staticStyle:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"}},[t("div",{staticClass:"summary-item"},[t("strong",[e._v("Código:")]),e._v(" "+e._s(e.service.code)+" ")]),t("div",{staticClass:"summary-item"},[t("strong",[e._v("Fecha y Hora:")]),e._v(" "+e._s(e.formatDate(e.service.serviceDate))+" a las "+e._s(e.service.departureTime)+" ")]),t("div",{staticClass:"summary-item"},[t("strong",[e._v("Vehículo:")]),e._v(" "+e._s(e.vehicleSearchQuery||"No seleccionado")+" ")]),t("div",{staticClass:"summary-item"},[t("strong",[e._v("Conductor:")]),e._v(" "+e._s(e.driverSearchQuery||"No seleccionado")+" ")]),t("div",{staticClass:"summary-item"},[t("strong",[e._v("Origen:")]),e._v(" "+e._s(e.service.origin.district)+" - "+e._s(e.service.origin.address)+" ")]),t("div",{staticClass:"summary-item"},[t("strong",[e._v("Destinos:")]),e._v(" "+e._s(e.service.destinations.length)+" punto(s) ")])])])])])],1)},s=[function(){var e=this,t=e._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"fas fa-info-circle"}),e._v(" Información del Servicio ")])},function(){var e=this,t=e._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"fas fa-route"}),e._v(" Ruta del Servicio ")])},function(){var e=this,t=e._self._c;return t("label",{staticClass:"form-label"},[t("i",{staticClass:"fas fa-map-marker-alt",staticStyle:{color:"#28a745","margin-right":"0.5rem"}}),e._v(" Punto de Origen * ")])},function(){var e=this,t=e._self._c;return t("h3",{staticStyle:{"margin-bottom":"1rem",color:"var(--color-turquoise)"}},[t("i",{staticClass:"fas fa-clipboard-check",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Resumen del Servicio ")])}],a=i(4048),n=i(8676),o=i(388),c=(i(8706),i(8431),i(2008),i(113),i(4423),i(4346),i(4114),i(4782),i(4554),i(9089),i(1688),i(3288),i(8111),i(1148),i(2489),i(116),i(6099),i(1699),i(7764),i(2953),i(3690)),l=i(4300);const d={name:"ServiceForm",components:{Header:c.Y9},data:function(){return{loading:!1,error:null,isEditing:!1,service:{id:null,code:"",serviceDate:"",departureTime:"",vehicleId:"",driverId:"",origin:{address:"",district:""},destinations:[{address:"",district:""}],observations:"",status:"pending"},vehicles:[],drivers:[],vehicleSearchQuery:"",driverSearchQuery:"",vehicleSuggestions:[],driverSuggestions:[],showVehicleSuggestions:!1,showDriverSuggestions:!1,limaDistricts:["Ancón","Ate","Barranco","Breña","Carabayllo","Chaclacayo","Chorrillos","Cieneguilla","Comas","El Agustino","Independencia","Jesús María","La Molina","La Victoria","Lima","Lince","Los Olivos","Lurigancho","Lurín","Magdalena del Mar","Miraflores","Pachacámac","Pucusana","Pueblo Libre","Puente Piedra","Punta Hermosa","Punta Negra","Rímac","San Bartolo","San Borja","San Isidro","San Juan de Lurigancho","San Juan de Miraflores","San Luis","San Martín de Porres","San Miguel","Santa Anita","Santa María del Mar","Santa Rosa","Santiago de Surco","Surquillo","Villa El Salvador","Villa María del Triunfo"],originSuggestions:[],destinationSuggestions:[],showOriginSuggestions:!1,activeDestinationIndex:-1,mockVehicles:[],mockDrivers:[]}},computed:{availableVehicles:function(){return Array.isArray(this.vehicles)?this.vehicles.filter((function(e){return 1===e.status})):[]},availableDrivers:function(){return Array.isArray(this.drivers)?this.drivers.filter((function(e){return 1===e.status})):[]},isFormValid:function(){return this.service.serviceDate&&this.service.departureTime&&this.service.vehicleId&&this.service.driverId&&this.service.origin.address&&this.service.origin.district&&this.service.destinations.length>0&&this.service.destinations.every((function(e){return e.address&&e.district}))}},methods:{loadData:function(){var e=this;return(0,o.A)((0,a.A)().mark((function t(){var i,r,s,o;return(0,a.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.error=null,t.prev=2,t.next=5,Promise.all([l.Ax.getAll(),l.qE.getAll()]);case 5:if(i=t.sent,r=(0,n.A)(i,2),s=r[0],o=r[1],e.vehicles=s.data,e.drivers=o.data,!e.$route.params.id){t.next=16;break}return t.next=14,e.loadServiceData(e.$route.params.id);case 14:t.next=18;break;case 16:return t.next=18,e.generateServiceCode();case 18:t.next=25;break;case 20:t.prev=20,t.t0=t["catch"](2),console.error("Error loading data:",t.t0),e.error="Error al cargar los datos",e.$handleApiError(t.t0,"Error al cargar datos del formulario");case 25:return t.prev=25,e.loading=!1,t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[2,20,25,28]])})))()},loadServiceData:function(e){var t=this;return(0,o.A)((0,a.A)().mark((function i(){var r,s,n;return(0,a.A)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,l.dJ.getById(e);case 3:r=i.sent,t.service=r.data,t.isEditing=!0,t.service.vehicleId&&(s=t.vehicles.find((function(e){return e.id==t.service.vehicleId})),s&&(t.vehicleSearchQuery="".concat(s.licensePlate," - ").concat(s.brand," ").concat(s.model))),t.service.driverId&&(n=t.drivers.find((function(e){return e.id==t.service.driverId})),n&&(t.driverSearchQuery="".concat(n.fullName," - ").concat(n.licenseNumber))),i.next=15;break;case 10:i.prev=10,i.t0=i["catch"](0),console.error("Error loading service data:",i.t0),t.error="Error al cargar los datos del servicio",t.$handleApiError(i.t0,"Error al cargar el servicio");case 15:case"end":return i.stop()}}),i,null,[[0,10]])})))()},generateServiceCode:function(){var e=this;return(0,o.A)((0,a.A)().mark((function t(){var i;return(0,a.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.dJ.getNextCode();case 3:i=t.sent,e.service.code=i.data.code,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("Error generating service code:",t.t0),e.service.code="P".concat(String(Date.now()).slice(-5));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},searchVehicles:function(){if(this.vehicleSearchQuery.length>0){var e=this.vehicleSearchQuery.toLowerCase();this.vehicleSuggestions=this.availableVehicles.filter((function(t){return t.licensePlate.toLowerCase().includes(e)||t.brand.toLowerCase().includes(e)||t.model.toLowerCase().includes(e)})).slice(0,5)}else this.vehicleSuggestions=this.availableVehicles.slice(0,5)},searchDrivers:function(){if(this.driverSearchQuery.length>0){var e=this.driverSearchQuery.toLowerCase();this.driverSuggestions=this.availableDrivers.filter((function(t){return t.fullName.toLowerCase().includes(e)||t.licenseNumber.toLowerCase().includes(e)})).slice(0,5)}else this.driverSuggestions=this.availableDrivers.slice(0,5)},selectVehicle:function(e){this.service.vehicleId=e.id,this.vehicleSearchQuery="".concat(e.licensePlate," - ").concat(e.brand," ").concat(e.model),this.vehicleSuggestions=[],this.showVehicleSuggestions=!1},selectDriver:function(e){this.service.driverId=e.id,this.driverSearchQuery="".concat(e.fullName," - ").concat(e.licenseNumber),this.driverSuggestions=[],this.showDriverSuggestions=!1},searchOriginDistricts:function(){var e=this;this.service.origin.district.length>0?this.originSuggestions=this.limaDistricts.filter((function(t){return t.toLowerCase().includes(e.service.origin.district.toLowerCase())})).slice(0,5):this.originSuggestions=[]},searchDestinationDistricts:function(e){var t=this.service.destinations[e].district;t&&t.length>0?this.destinationSuggestions=this.limaDistricts.filter((function(e){return e.toLowerCase().includes(t.toLowerCase())})).slice(0,5):this.destinationSuggestions=[]},selectOriginDistrict:function(e){this.service.origin.district=e,this.originSuggestions=[],this.showOriginSuggestions=!1},selectDestinationDistrict:function(e,t){this.service.destinations[t].district=e,this.destinationSuggestions=[],this.activeDestinationIndex=-1},addDestination:function(){this.service.destinations.push({address:"",district:""})},removeDestination:function(e){this.service.destinations.length>1&&this.service.destinations.splice(e,1)},saveService:function(){var e=this;return(0,o.A)((0,a.A)().mark((function t(){var i;return(0,a.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isFormValid){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e.loading=!0,i={code:e.service.code,serviceDate:e.service.serviceDate,departureTime:e.service.departureTime,vehicleId:e.service.vehicleId,driverId:e.service.driverId,origin:e.service.origin,destinations:e.service.destinations,observations:e.service.observations,status:e.service.status||"pending"},!e.isEditing){t.next=11;break}return t.next=8,l.dJ.update(e.service.id,i);case 8:e.$notify("Servicio actualizado correctamente","success"),t.next=14;break;case 11:return t.next=13,l.dJ.create(i);case 13:e.$notify("Servicio creado correctamente","success");case 14:e.$router.push("/fleet-management"),t.next=21;break;case 17:t.prev=17,t.t0=t["catch"](2),console.error("Error saving service:",t.t0),e.$handleApiError(t.t0,"Error al ".concat(e.isEditing?"actualizar":"crear"," el servicio"));case 21:return t.prev=21,e.loading=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[2,17,21,24]])})))()},cancelForm:function(){confirm("¿Está seguro que desea cancelar? Se perderán los cambios no guardados.")&&this.$router.push("/fleet-management")},formatDate:function(e){if(!e)return"N/A";var t=new Date(e);return t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})}},created:function(){var e=this;return(0,o.A)((0,a.A)().mark((function t(){return(0,a.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.service.serviceDate=(new Date).toISOString().split("T")[0],t.next=3,e.loadData();case 3:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;document.addEventListener("click",(function(t){t.target.closest(".form-group")||(e.vehicleSuggestions=[],e.driverSuggestions=[],e.originSuggestions=[],e.destinationSuggestions=[],e.showVehicleSuggestions=!1,e.showDriverSuggestions=!1,e.showOriginSuggestions=!1,e.activeDestinationIndex=-1)}))}},u=d;var v=i(1656),g=(0,v.A)(u,r,s,!1,null,"59e1839f",null);const m=g.exports},8431:(e,t,i)=>{var r=i(6518),s=i(9213).every,a=i(4598),n=a("every");r({target:"Array",proto:!0,forced:!n},{every:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},8706:(e,t,i)=>{var r=i(6518),s=i(9039),a=i(4376),n=i(34),o=i(8981),c=i(6198),l=i(6837),d=i(4659),u=i(1469),v=i(597),g=i(8227),m=i(9519),h=g("isConcatSpreadable"),f=m>=51||!s((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),p=function(e){if(!n(e))return!1;var t=e[h];return void 0!==t?!!t:a(e)},S=!f||!v("concat");r({target:"Array",proto:!0,arity:1,forced:S},{concat:function(e){var t,i,r,s,a,n=o(this),v=u(n,0),g=0;for(t=-1,r=arguments.length;t<r;t++)if(a=-1===t?n:arguments[t],p(a))for(s=c(a),l(g+s),i=0;i<s;i++,g++)i in a&&d(v,g,a[i]);else l(g+1),d(v,g++,a);return v.length=g,v}})}}]);