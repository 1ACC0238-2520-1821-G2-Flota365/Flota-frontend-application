"use strict";(self["webpackChunkflota365_vue"]=self["webpackChunkflota365_vue"]||[]).push([[446],{706:(e,t,r)=>{var i=r(350).PROPER,s=r(9039),a=r(7452),o="​᠎";e.exports=function(e){return s((function(){return!!a[e]()||o[e]()!==o||i&&a[e].name!==e}))}},2762:(e,t,r)=>{var i=r(6518),s=r(3802).trim,a=r(706);i({target:"String",proto:!0,forced:a("trim")},{trim:function(){return s(this)}})},9446:(e,t,r)=>{r.r(t),r.d(t,{default:()=>C});var i=function(){var e,t,r,i,s,a=this,o=a._self._c;return o("div",[o("Header",{attrs:{title:"Gestión de Conductores"}}),o("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"1.875rem"}},[o("div",[o("button",{staticClass:"btn btn-primary",on:{click:a.openCreateModal}},[o("i",{staticClass:"fas fa-plus",staticStyle:{"margin-right":"0.5rem"}}),a._v(" Nuevo Conductor ")]),o("button",{staticClass:"btn btn-secondary",staticStyle:{"margin-left":"0.5rem"},on:{click:a.refreshData}},[o("i",{staticClass:"fas fa-redo-alt",staticStyle:{"margin-right":"0.5rem"}}),a._v(" Actualizar ")])]),o("div",{staticClass:"form-group",staticStyle:{width:"300px",margin:"0"}},[o("div",{staticStyle:{position:"relative"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.searchQuery,expression:"searchQuery"}],staticClass:"form-control",staticStyle:{"padding-right":"35px"},attrs:{type:"text",placeholder:"Buscar conductor..."},domProps:{value:a.searchQuery},on:{input:function(e){e.target.composing||(a.searchQuery=e.target.value)}}}),o("i",{staticClass:"fas fa-search",staticStyle:{position:"absolute",right:"10px",top:"12px",color:"#666"}})])])]),a.statsLoading?a._e():o("div",{staticClass:"dashboard-grid",staticStyle:{"margin-bottom":"1.875rem"}},[o("div",{staticClass:"stats-card"},[o("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},[o("div",[o("div",{staticClass:"stats-label"},[a._v("Total Conductores")]),o("div",{staticClass:"stats-value"},[a._v(a._s((null===(e=a.driverStats)||void 0===e?void 0:e.totalDrivers)||0))]),a._m(0)]),a._m(1)])]),o("div",{staticClass:"stats-card"},[o("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},[o("div",[o("div",{staticClass:"stats-label"},[a._v("Conductores Activos")]),o("div",{staticClass:"stats-value"},[a._v(a._s((null===(t=a.driverStats)||void 0===t?void 0:t.activeDrivers)||0))]),o("div",{staticStyle:{color:"var(--color-success)","font-size":"0.875rem"}},[o("i",{staticClass:"fas fa-arrow-up"}),a._v(" "+a._s((null===(r=a.driverStats)||void 0===r?void 0:r.activePercentage)||0)+"% del total ")])]),a._m(2)])]),o("div",{staticClass:"stats-card"},[o("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},[o("div",[o("div",{staticClass:"stats-label"},[a._v("Licencias por vencer")]),o("div",{staticClass:"stats-value"},[a._v(a._s((null===(i=a.driverStats)||void 0===i?void 0:i.licensesExpiringSoon)||0))]),a._m(3)]),a._m(4)])]),o("div",{staticClass:"stats-card"},[o("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},[o("div",[o("div",{staticClass:"stats-label"},[a._v("Experiencia Promedio")]),o("div",{staticClass:"stats-value"},[a._v(a._s((null===(s=a.driverStats)||void 0===s?void 0:s.averageExperience)||0))]),a._m(5)]),a._m(6)])])]),a.statsLoading?o("div",{staticClass:"dashboard-grid",staticStyle:{"margin-bottom":"1.875rem"}},a._l(4,(function(e){return o("div",{key:e,staticClass:"stats-card"},[a._m(7,!0)])})),0):a._e(),a.loading&&0===a.drivers.length?o("div",{staticStyle:{"text-align":"center",padding:"3rem"}},[o("i",{staticClass:"fas fa-spinner fa-spin",staticStyle:{"font-size":"3rem",color:"var(--color-turquoise)","margin-bottom":"1rem"}}),o("p",[a._v("Cargando conductores...")])]):a.error?o("div",{staticStyle:{"text-align":"center",padding:"3rem",background:"#fee",border:"1px solid #fcc","border-radius":"8px","margin-bottom":"2rem"}},[o("i",{staticClass:"fas fa-exclamation-triangle",staticStyle:{"font-size":"3rem",color:"var(--color-error)","margin-bottom":"1rem"}}),o("h3",{staticStyle:{color:"var(--color-error)"}},[a._v("Error al cargar conductores")]),o("p",[a._v(a._s(a.error))]),o("button",{staticClass:"btn btn-primary",on:{click:a.loadDrivers}},[o("i",{staticClass:"fas fa-redo"}),a._v(" Reintentar ")])]):o("div",{staticClass:"card"},[o("div",{staticClass:"card-header"},[o("h2",{staticClass:"card-title"},[a._v("Conductores ("+a._s(a.filteredDrivers.length)+")")]),o("div",[o("button",{staticClass:"btn btn-secondary",attrs:{disabled:0===a.filteredDrivers.length},on:{click:a.exportDrivers}},[o("i",{staticClass:"fas fa-download",staticStyle:{"margin-right":"0.5rem"}}),a._v(" Exportar ")])])]),o("table",{staticClass:"data-table"},[a._m(8),o("tbody",a._l(a.paginatedDrivers,(function(e){return o("tr",{key:e.id},[o("td",[o("span",{staticStyle:{"font-family":"monospace",background:"var(--color-gray-light)",padding:"0.25rem 0.5rem","border-radius":"4px"}},[a._v(" "+a._s(e.code)+" ")])]),o("td",[o("div",[o("div",{staticStyle:{"font-weight":"600"}},[a._v(a._s(e.fullName))]),o("div",{staticStyle:{"font-size":"0.85rem",color:"#666"}},[o("i",{staticClass:"fas fa-envelope"}),a._v(" "+a._s(e.email||"Sin email")+" ")])])]),o("td",[a._v(a._s(e.licenseNumber))]),o("td",[o("span",{style:{color:e.isLicenseExpiringSoon?"var(--color-error)":"var(--color-text)"}},[a._v(" "+a._s(a.formatDate(e.licenseExpiryDate))+" ")]),e.isLicenseExpiringSoon?o("div",{staticStyle:{"font-size":"0.75rem",color:"var(--color-error)"}},[o("i",{staticClass:"fas fa-exclamation-triangle"}),a._v(" Por vencer ")]):a._e()]),o("td",[o("StatusBadge",{attrs:{status:a.getStatusKey(e.status),text:e.statusName}})],1),o("td",[a._v(a._s(e.assignedVehicle||"No asignado"))]),o("td",[a._v(a._s(e.experienceYears)+" años")]),o("td",[o("div",{staticStyle:{display:"flex",gap:"0.25rem"}},[o("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"},on:{click:function(t){return a.viewDriver(e)}}},[o("i",{staticClass:"fas fa-eye"})]),o("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"},on:{click:function(t){return a.editDriver(e)}}},[o("i",{staticClass:"fas fa-edit"})]),o("button",{staticClass:"btn btn-danger",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"},on:{click:function(t){return a.confirmDelete(e)}}},[o("i",{staticClass:"fas fa-trash"})])])])])})),0)]),0!==a.filteredDrivers.length||a.loading?a._e():o("div",{staticStyle:{"text-align":"center",padding:"3rem",color:"#666"}},[o("i",{staticClass:"fas fa-users",staticStyle:{"font-size":"4rem","margin-bottom":"1rem",opacity:"0.3"}}),o("h3",[a._v("No se encontraron conductores")]),a.searchQuery?o("p",[a._v("Intenta ajustar el término de búsqueda")]):o("p",[a._v("Comienza agregando tu primer conductor")]),a.searchQuery?a._e():o("button",{staticClass:"btn btn-primary",on:{click:a.openCreateModal}},[o("i",{staticClass:"fas fa-plus"}),a._v(" Agregar Conductor ")])]),a.filteredDrivers.length>a.itemsPerPage?o("Pagination",{attrs:{"current-page":a.currentPage,"total-items":a.filteredDrivers.length,"per-page":a.itemsPerPage,"item-label":"conductores"},on:{"page-change":a.changePage}}):a._e()],1),o("Modal",{attrs:{show:a.showDriverModal,title:a.isEditing?"Editar Conductor":"Registrar nuevo conductor"},on:{close:a.closeDriverModal}},[o("DriverForm",{attrs:{"driver-data":a.editingDriver,loading:a.actionLoading},on:{submit:a.saveDriver,cancel:a.closeDriverModal}})],1),o("Modal",{attrs:{show:a.showStatsModal,title:"Estadísticas del Conductor"},on:{close:function(e){a.showStatsModal=!1}},scopedSlots:a._u([{key:"footer",fn:function(){return[o("button",{staticClass:"btn btn-secondary",on:{click:function(e){a.showStatsModal=!1}}},[a._v("Cerrar")]),o("button",{staticClass:"btn btn-primary",on:{click:function(e){return a.editDriver(a.selectedDriver)}}},[o("i",{staticClass:"fas fa-edit",staticStyle:{"margin-right":"0.5rem"}}),a._v(" Editar Conductor ")])]},proxy:!0}])},[a.selectedDriver?o("div",[o("h3",[a._v(a._s(a.selectedDriver.fullName))]),o("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem",margin:"1rem 0"}},[o("div",{staticStyle:{"background-color":"var(--color-gray-light)",padding:"1rem","border-radius":"4px","text-align":"center"}},[o("h4",[a._v("Licencia")]),o("div",{staticStyle:{"font-size":"1.5rem","font-weight":"bold",color:"var(--color-turquoise)"}},[a._v(a._s(a.selectedDriver.licenseNumber))]),o("div",{style:{color:a.selectedDriver.isLicenseExpiringSoon?"var(--color-error)":"var(--color-success)",fontSize:"0.875rem"}},[o("i",{class:a.selectedDriver.isLicenseExpiringSoon?"fas fa-exclamation-triangle":"fas fa-check-circle"}),a._v(" "+a._s(a.selectedDriver.isLicenseExpiringSoon?"Por vencer":"Vigente")+" ")])]),o("div",{staticStyle:{"background-color":"var(--color-gray-light)",padding:"1rem","border-radius":"4px","text-align":"center"}},[o("h4",[a._v("Experiencia")]),o("div",{staticStyle:{"font-size":"1.5rem","font-weight":"bold",color:"var(--color-turquoise)"}},[a._v(a._s(a.selectedDriver.experienceYears))]),o("div",{staticStyle:{color:"var(--color-success)","font-size":"0.875rem"}},[o("i",{staticClass:"fas fa-road"}),a._v(" años ")])])]),o("div",{staticStyle:{"background-color":"var(--color-gray-light)",padding:"1rem","border-radius":"4px"}},[o("h4",[a._v("Información de Contacto")]),o("p",[o("strong",[a._v("Email:")]),a._v(" "+a._s(a.selectedDriver.email||"No registrado"))]),o("p",[o("strong",[a._v("Teléfono:")]),a._v(" "+a._s(a.selectedDriver.phone||"No registrado"))]),o("p",[o("strong",[a._v("Vehículo asignado:")]),a._v(" "+a._s(a.selectedDriver.assignedVehicle||"Sin asignar"))])])]):a._e()]),o("Notification",{ref:"notification"})],1)},s=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{color:"var(--color-success)","font-size":"0.875rem"}},[t("i",{staticClass:"fas fa-users"}),e._v(" Registrados ")])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"stats-icon"},[t("i",{staticClass:"fas fa-users"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"stats-icon"},[t("i",{staticClass:"fas fa-user-check"})])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{color:"var(--color-warning)","font-size":"0.875rem"}},[t("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" Próximos 30 días ")])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"stats-icon"},[t("i",{staticClass:"fas fa-id-card"})])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{color:"var(--color-success)","font-size":"0.875rem"}},[t("i",{staticClass:"fas fa-clock"}),e._v(" años ")])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"stats-icon"},[t("i",{staticClass:"fas fa-road"})])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"text-align":"center",padding:"1rem"}},[t("i",{staticClass:"fas fa-spinner fa-spin",staticStyle:{"font-size":"1.5rem",color:"var(--color-turquoise)"}})])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Código")]),t("th",[e._v("Nombre Completo")]),t("th",[e._v("Licencia")]),t("th",[e._v("Vencimiento")]),t("th",[e._v("Estado")]),t("th",[e._v("Vehículo")]),t("th",[e._v("Experiencia")]),t("th",[e._v("Acciones")])])])}],a=r(9258),o=r(4048),n=r(388),c=r(9201),l=(r(8706),r(2008),r(4423),r(8598),r(2062),r(4782),r(3288),r(8111),r(2489),r(1701),r(9432),r(6099),r(1699),r(7764),r(2953),r(3296),r(7208),r(8408),r(4603),r(7566),r(8721),r(5353)),d=r(3690),v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"driver-form"},[t("form",{attrs:{id:"driverForm"},on:{submit:function(t){return t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[t("div",{staticClass:"form-section"},[t("h3",[e._v("Información Personal")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label required",attrs:{for:"firstName"}},[e._v("Nombre *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.driver.firstName,expression:"driver.firstName"}],staticClass:"form-control",class:{error:e.errors.firstName},attrs:{type:"text",id:"firstName",disabled:e.loading,required:"",maxlength:"50"},domProps:{value:e.driver.firstName},on:{input:function(t){t.target.composing||e.$set(e.driver,"firstName",t.target.value)}}}),e.errors.firstName?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.firstName))]):e._e()]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label required",attrs:{for:"lastName"}},[e._v("Apellidos *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.driver.lastName,expression:"driver.lastName"}],staticClass:"form-control",class:{error:e.errors.lastName},attrs:{type:"text",id:"lastName",disabled:e.loading,required:"",maxlength:"50"},domProps:{value:e.driver.lastName},on:{input:function(t){t.target.composing||e.$set(e.driver,"lastName",t.target.value)}}}),e.errors.lastName?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.lastName))]):e._e()])])]),t("div",{staticClass:"form-section"},[t("h3",[e._v("Información de Contacto")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"email"}},[e._v("Correo electrónico")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.driver.email,expression:"driver.email"}],staticClass:"form-control",class:{error:e.errors.email},attrs:{type:"email",id:"email",disabled:e.loading,maxlength:"100",placeholder:"ejemplo@correo.com"},domProps:{value:e.driver.email},on:{input:function(t){t.target.composing||e.$set(e.driver,"email",t.target.value)}}}),e.errors.email?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.email))]):e._e()]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"phone"}},[e._v("Teléfono")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.driver.phone,expression:"driver.phone"}],staticClass:"form-control",class:{error:e.errors.phone},attrs:{type:"tel",id:"phone",disabled:e.loading,maxlength:"20",placeholder:"+51 999 123 456"},domProps:{value:e.driver.phone},on:{input:function(t){t.target.composing||e.$set(e.driver,"phone",t.target.value)}}}),e.errors.phone?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.phone))]):e._e()])])]),t("div",{staticClass:"form-section"},[t("h3",[e._v("Información de Licencia")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label required",attrs:{for:"licenseNumber"}},[e._v("Número de licencia *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.driver.licenseNumber,expression:"driver.licenseNumber"}],staticClass:"form-control",class:{error:e.errors.licenseNumber},attrs:{type:"text",id:"licenseNumber",disabled:e.loading,required:"",maxlength:"20",placeholder:"Q12345678"},domProps:{value:e.driver.licenseNumber},on:{input:function(t){t.target.composing||e.$set(e.driver,"licenseNumber",t.target.value)}}}),e.errors.licenseNumber?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.licenseNumber))]):e._e()]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label required",attrs:{for:"licenseExpiryDate"}},[e._v("Fecha de vencimiento *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.driver.licenseExpiryDate,expression:"driver.licenseExpiryDate"}],staticClass:"form-control",class:{error:e.errors.licenseExpiryDate},attrs:{type:"date",id:"licenseExpiryDate",disabled:e.loading,min:e.todayDate,required:""},domProps:{value:e.driver.licenseExpiryDate},on:{input:function(t){t.target.composing||e.$set(e.driver,"licenseExpiryDate",t.target.value)}}}),e.errors.licenseExpiryDate?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.licenseExpiryDate))]):e._e()])])]),t("div",{staticClass:"form-section"},[t("h3",[e._v("Experiencia")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"experienceYears"}},[e._v("Años de experiencia")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.driver.experienceYears,expression:"driver.experienceYears",modifiers:{number:!0}}],staticClass:"form-control",class:{error:e.errors.experienceYears},attrs:{type:"number",id:"experienceYears",disabled:e.loading,min:"0",max:"50",placeholder:"0"},domProps:{value:e.driver.experienceYears},on:{input:function(t){t.target.composing||e.$set(e.driver,"experienceYears",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),e.errors.experienceYears?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.experienceYears))]):e._e()]),e.isEdit?t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"status"}},[e._v("Estado")]),t("select",{directives:[{name:"model",rawName:"v-model.number",value:e.driver.status,expression:"driver.status",modifiers:{number:!0}}],staticClass:"form-control",attrs:{id:"status",disabled:e.loading},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(t){var r="_value"in t?t._value:t.value;return e._n(r)}));e.$set(e.driver,"status",t.target.multiple?r:r[0])}}},[t("option",{domProps:{value:1}},[e._v("Activo")]),t("option",{domProps:{value:2}},[e._v("Inactivo")]),t("option",{domProps:{value:3}},[e._v("En descanso")])])]):e._e()])]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn btn-secondary",attrs:{type:"button",disabled:e.loading},on:{click:function(t){return e.$emit("cancel")}}},[e._v(" Cancelar ")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.loading||!e.isFormValid}},[e.loading?t("i",{staticClass:"fas fa-spinner fa-spin",staticStyle:{"margin-right":"0.5rem"}}):t("i",{staticClass:"fas fa-save",staticStyle:{"margin-right":"0.5rem"}}),e._v(" "+e._s(e.loading?"Guardando...":e.isEdit?"Actualizar":"Crear")+" conductor ")])])])])},u=[];r(1629),r(1688),r(7588),r(7495),r(906),r(2762),r(3500);const m={name:"DriverForm",props:{driverData:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},data:function(){return{driver:{firstName:"",lastName:"",email:"",phone:"",licenseNumber:"",licenseExpiryDate:"",experienceYears:0,status:1},errors:{}}},computed:{isEdit:function(){return!(!this.driverData||!this.driverData.id)},todayDate:function(){return(new Date).toISOString().split("T")[0]},isFormValid:function(){return this.driver.firstName&&this.driver.lastName&&this.driver.licenseNumber&&this.driver.licenseExpiryDate&&0===Object.keys(this.errors).length}},watch:{driverData:{immediate:!0,handler:function(e){e&&Object.keys(e).length>0?this.loadDriverData(e):this.resetForm()}},"driver.firstName":function(){this.validateField("firstName")},"driver.lastName":function(){this.validateField("lastName")},"driver.email":function(){this.validateField("email")},"driver.phone":function(){this.validateField("phone")},"driver.licenseNumber":function(){this.validateField("licenseNumber")},"driver.licenseExpiryDate":function(){this.validateField("licenseExpiryDate")},"driver.experienceYears":function(){this.validateField("experienceYears")}},methods:{loadDriverData:function(e){this.driver={firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||"",licenseNumber:e.licenseNumber||"",licenseExpiryDate:e.licenseExpiryDate?e.licenseExpiryDate.split("T")[0]:"",experienceYears:e.experienceYears||0,status:e.status||1},this.errors={}},resetForm:function(){this.driver={firstName:"",lastName:"",email:"",phone:"",licenseNumber:"",licenseExpiryDate:"",experienceYears:0,status:1},this.errors={}},validateField:function(e){switch(e){case"firstName":this.driver.firstName.trim()?this.driver.firstName.length<2?this.$set(this.errors,"firstName","El nombre debe tener al menos 2 caracteres"):this.$delete(this.errors,"firstName"):this.$set(this.errors,"firstName","El nombre es requerido");break;case"lastName":this.driver.lastName.trim()?this.driver.lastName.length<2?this.$set(this.errors,"lastName","El apellido debe tener al menos 2 caracteres"):this.$delete(this.errors,"lastName"):this.$set(this.errors,"lastName","El apellido es requerido");break;case"email":if(this.driver.email){var t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;t.test(this.driver.email)?this.$delete(this.errors,"email"):this.$set(this.errors,"email","Ingrese un correo electrónico válido")}else this.$delete(this.errors,"email");break;case"phone":if(this.driver.phone){var r=/^[+]?[0-9\s\-()]{9,}$/;r.test(this.driver.phone)?this.$delete(this.errors,"phone"):this.$set(this.errors,"phone","Ingrese un número de teléfono válido")}else this.$delete(this.errors,"phone");break;case"licenseNumber":this.driver.licenseNumber.trim()?this.driver.licenseNumber.length<5?this.$set(this.errors,"licenseNumber","El número debe tener al menos 5 caracteres"):this.$delete(this.errors,"licenseNumber"):this.$set(this.errors,"licenseNumber","El número de licencia es requerido");break;case"licenseExpiryDate":if(this.driver.licenseExpiryDate){var i=new Date(this.driver.licenseExpiryDate),s=new Date;i<=s?this.$set(this.errors,"licenseExpiryDate","La fecha debe ser futura"):this.$delete(this.errors,"licenseExpiryDate")}else this.$set(this.errors,"licenseExpiryDate","La fecha de vencimiento es requerida");break;case"experienceYears":this.driver.experienceYears<0?this.$set(this.errors,"experienceYears","No puede ser negativo"):this.driver.experienceYears>50?this.$set(this.errors,"experienceYears","Máximo 50 años"):this.$delete(this.errors,"experienceYears");break}},validateForm:function(){var e=this;return Object.keys(this.driver).forEach((function(t){e.validateField(t)})),0===Object.keys(this.errors).length},handleSubmit:function(){if(this.validateForm()){var e=(0,c.A)({},this.driver);this.isEdit&&(e.id=this.driverData.id),this.$emit("submit",e)}}}},f=m;var h=r(1656),p=(0,h.A)(f,v,u,!1,null,"1166a2a3",null);const g=p.exports,b={name:"DriverManagement",components:{Header:d.Y9,StatusBadge:d.Wh,Modal:d.aF,Pagination:d.dK,DriverForm:g,Notification:d.Eg},data:function(){return{searchQuery:"",currentPage:1,itemsPerPage:10,showDriverModal:!1,showStatsModal:!1,editingDriver:{},selectedDriver:null,isEditing:!1,statsLoading:!1,actionLoading:!1}},computed:(0,c.A)((0,c.A)({},(0,l.aH)("drivers",{drivers:"drivers",driverStats:"driverStats",loading:"loading",error:"error"})),{},{filteredDrivers:function(){if(!this.searchQuery)return this.drivers;var e=this.searchQuery.toLowerCase();return this.drivers.filter((function(t){return t.fullName&&t.fullName.toLowerCase().includes(e)||t.firstName&&t.firstName.toLowerCase().includes(e)||t.lastName&&t.lastName.toLowerCase().includes(e)||t.code&&t.code.toLowerCase().includes(e)||t.licenseNumber&&t.licenseNumber.toLowerCase().includes(e)||t.email&&t.email.toLowerCase().includes(e)}))},paginatedDrivers:function(){var e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.filteredDrivers.slice(e,t)}}),methods:(0,c.A)((0,c.A)({},(0,l.i0)("drivers",["fetchDrivers","fetchDriverStats","createDriver","updateDriver","deleteDriver"])),{},{loadDrivers:function(){var e=this;return(0,n.A)((0,o.A)().mark((function t(){return(0,o.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.statsLoading=!0,t.next=4,Promise.all([e.fetchDrivers(),e.fetchDriverStats()]);case 4:e.statsLoading=!1,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),e.statsLoading=!1,e.showNotification("Error al cargar los datos","error");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},refreshData:function(){var e=this;return(0,n.A)((0,o.A)().mark((function t(){return(0,o.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadDrivers();case 2:e.showNotification("Datos actualizados correctamente","success");case 3:case"end":return t.stop()}}),t)})))()},getStatusKey:function(e){var t={1:"active",2:"inactive",3:"warning"};return t[e]||"inactive"},formatDate:function(e){if(!e)return"N/A";var t=new Date(e);return t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},openCreateModal:function(){this.editingDriver={},this.isEditing=!1,this.showDriverModal=!0},viewDriver:function(e){this.selectedDriver=e,this.showStatsModal=!0},editDriver:function(e){this.editingDriver=(0,c.A)({},e),this.isEditing=!0,this.showDriverModal=!0,this.showStatsModal=!1},closeDriverModal:function(){this.showDriverModal=!1,this.editingDriver={},this.isEditing=!1,this.actionLoading=!1},saveDriver:function(e){var t=this;return(0,n.A)((0,o.A)().mark((function r(){return(0,o.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.actionLoading=!0,r.prev=1,!t.isEditing){r.next=8;break}return r.next=5,t.updateDriver({id:e.id,driverData:e});case 5:t.showNotification("Conductor actualizado correctamente","success"),r.next=11;break;case 8:return r.next=10,t.createDriver(e);case 10:t.showNotification("Conductor creado correctamente","success");case 11:return t.closeDriverModal(),r.next=14,t.fetchDriverStats();case 14:r.next=19;break;case 16:r.prev=16,r.t0=r["catch"](1),t.showNotification(r.t0.message||"Error al guardar el conductor","error");case 19:return r.prev=19,t.actionLoading=!1,r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[1,16,19,22]])})))()},confirmDelete:function(e){confirm("¿Está seguro de eliminar al conductor ".concat(e.fullName,"?"))&&this.handleDelete(e.id)},handleDelete:function(e){var t=this;return(0,n.A)((0,o.A)().mark((function r(){return(0,o.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.deleteDriver(e);case 3:return t.showNotification("Conductor eliminado correctamente","success"),r.next=6,t.fetchDriverStats();case 6:r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](0),t.showNotification(r.t0.message||"Error al eliminar el conductor","error");case 11:case"end":return r.stop()}}),r,null,[[0,8]])})))()},changePage:function(e){this.currentPage=e},exportDrivers:function(){var e=this;try{var t=this.filteredDrivers.map((function(t){return{Código:t.code,"Nombre Completo":t.fullName,Email:t.email||"",Teléfono:t.phone||"","Número de Licencia":t.licenseNumber,"Vencimiento Licencia":e.formatDate(t.licenseExpiryDate),Estado:t.statusName,"Vehículo Asignado":t.assignedVehicle||"Sin asignar","Años de Experiencia":t.experienceYears}}));this.downloadCSV(t,"conductores.csv"),this.showNotification("Datos exportados correctamente","success")}catch(r){this.showNotification("Error al exportar los datos","error")}},downloadCSV:function(e,t){if(e.length){var r=Object.keys(e[0]),i=[r.join(",")].concat((0,a.A)(e.map((function(e){return r.map((function(t){return'"'.concat(e[t],'"')})).join(",")})))).join("\n"),s=new Blob([i],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");if(void 0!==o.download){var n=URL.createObjectURL(s);o.setAttribute("href",n),o.setAttribute("download",t),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}},showNotification:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.$refs.notification&&this.$refs.notification.addNotification(e,t)}}),created:function(){var e=this;return(0,n.A)((0,o.A)().mark((function t(){return(0,o.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadDrivers();case 2:case"end":return t.stop()}}),t)})))()},watch:{searchQuery:function(){this.currentPage=1}}},_=b;var y=(0,h.A)(_,i,s,!1,null,null,null);const C=y.exports}}]);